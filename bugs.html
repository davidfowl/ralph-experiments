
<!DOCTYPE html>
<html lang="en" data-color-mode="dark" data-dark-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bug Reproduction Slides</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0c10;
            --bg-secondary: #13161d;
            --bg-tertiary: #1c2029;
            --bg-card: #181c24;
            --border: #2d333b;
            --border-muted: #21262d;
            --text-primary: #f0f6fc;
            --text-secondary: #9198a1;
            --text-tertiary: #6e7681;
            --accent: #4493f8;
            --accent-emphasis: #1f6feb;
            --success: #3fb950;
            --success-subtle: rgba(46, 160, 67, 0.2);
            --danger: #f85149;
            --danger-subtle: rgba(248, 81, 73, 0.2);
            --warning: #d29922;
            --warning-subtle: rgba(187, 128, 9, 0.2);
            --purple: #a371f7;
            --purple-subtle: rgba(163, 113, 247, 0.2);
            --cyan: #39c5cf;
            --cyan-subtle: rgba(57, 197, 207, 0.2);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-primary);
            min-height: 100vh;
            color: var(--text-primary);
            font-size: 16px;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        .app {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 32px;
        }

        /* Header */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 32px;
            padding-bottom: 24px;
            border-bottom: 1px solid var(--border);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 14px;
        }

        .logo svg {
            width: 36px;
            height: 36px;
            fill: var(--accent);
        }

        .logo h1 {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            letter-spacing: -0.5px;
        }

        .home-link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border-radius: 8px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 18px;
            transition: all 0.15s;
        }

        .home-link:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .header-links {
            display: flex;
            gap: 12px;
        }

        .raw-data-link {
            font-size: 12px;
            color: var(--text-secondary);
            text-decoration: none;
            padding: 6px 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            transition: all 0.15s;
        }

        .raw-data-link:hover {
            color: var(--text-primary);
            border-color: var(--text-secondary);
        }

        .page-description {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.6;
            margin: 0 0 20px 0;
            padding: 12px 16px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
        }

        .page-description a {
            color: var(--accent);
            text-decoration: none;
        }

        .page-description a:hover {
            text-decoration: underline;
        }

        .page-description strong {
            color: var(--text-primary);
        }

        .help-toggle {
            background: none;
            border: 1px solid var(--border);
            color: var(--accent);
            padding: 4px 10px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            margin-left: 12px;
            transition: all 0.15s;
        }

        .help-toggle:hover {
            background: var(--accent);
            color: white;
        }

        .help-section {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            animation: slideDown 0.2s ease-out;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .help-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
        }

        .help-item {
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .help-item h3 {
            margin: 0 0 8px 0;
            font-size: 14px;
            color: var(--text-primary);
        }

        .help-item p {
            margin: 0;
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .help-item strong {
            color: var(--text-primary);
        }

        .stats {
            display: flex;
            gap: 12px;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 20px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            font-variant-numeric: tabular-nums;
        }

        .stat-value.success { color: var(--success); }
        .stat-value.danger { color: var(--danger); }
        .stat-value.warning { color: var(--warning); }
        .stat-value.cyan { color: var(--cyan); }

        .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* Filters */
        .filters-row {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            align-items: flex-start;
            margin-bottom: 28px;
        }

        .filters {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 6px;
            background: var(--bg-secondary);
            border-radius: 12px;
            flex: 1;
            margin-bottom: 24px;
        }

        /* Search */
        .search-box {
            position: relative;
            width: 100%;
        }

        .search-input {
            width: 100%;
            padding: 12px 16px 12px 44px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 15px;
            font-family: inherit;
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .search-input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(68, 147, 248, 0.2);
        }

        .search-input::placeholder {
            color: var(--text-tertiary);
        }

        .search-icon {
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            width: 18px;
            height: 18px;
            fill: var(--text-tertiary);
            pointer-events: none;
        }

        .search-clear {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            width: 24px;
            height: 24px;
            background: var(--bg-tertiary);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .search-clear svg {
            width: 14px;
            height: 14px;
            fill: var(--text-secondary);
        }

        .search-clear:hover {
            background: var(--border);
        }

        .search-box.has-value .search-clear {
            display: flex;
        }

        /* Results List View */
        .results-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .result-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px 20px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .result-item:hover {
            background: var(--bg-tertiary);
            border-color: var(--accent);
            transform: translateX(4px);
        }

        .result-bug-id {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-tertiary);
            min-width: 70px;
        }

        .result-title {
            flex: 1;
            font-size: 15px;
            font-weight: 500;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .result-conclusion {
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            text-transform: capitalize;
            white-space: nowrap;
        }

        .result-conclusion.reproduced { background: var(--success-subtle); color: var(--success); }
        .result-conclusion.not-reproduced { background: var(--danger-subtle); color: var(--danger); }
        .result-conclusion.needs-windows { background: var(--warning-subtle); color: var(--warning); }
        .result-conclusion.needs-info { background: var(--purple-subtle); color: var(--purple); }

        .result-tags {
            display: flex;
            gap: 6px;
            margin-left: 16px;
            margin-right: 16px;
        }

        .result-tag {
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 600;
        }

        .result-tag.full { background: var(--success-subtle); color: var(--success); }
        .result-tag.source { background: var(--purple-subtle); color: var(--purple); }
        .result-tag.steps { background: var(--cyan-subtle); color: var(--cyan); }

        .results-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 32px;
            margin-bottom: 16px;
        }

        .results-count {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .results-back {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .results-back:hover {
            background: var(--bg-tertiary);
        }

        .results-back svg {
            width: 16px;
            height: 16px;
            fill: currentColor;
        }

        .filter-btn {
            padding: 10px 18px;
            background: transparent;
            border: none;
            border-radius: 8px;
            color: var(--text-secondary);
            white-space: nowrap;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .filter-btn:hover {
            color: var(--text-primary);
            background: var(--bg-tertiary);
        }

        .filter-btn.active {
            background: var(--accent-emphasis);
            color: white;
            box-shadow: 0 2px 8px rgba(31, 111, 235, 0.3);
        }

        .filter-btn.active.exclude {
            background: var(--danger);
            box-shadow: 0 2px 8px rgba(248, 81, 73, 0.3);
        }

        /* Component Filters */
        .component-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 16px;
        }

        .component-btn {
            padding: 4px 10px;
            font-size: 11px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.15s;
        }

        .component-btn:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        .component-btn.active {
            background: var(--cyan);
            color: #000;
            border-color: var(--cyan);
        }

        .component-btn.active.exclude {
            background: var(--danger);
            color: white;
            border-color: var(--danger);
        }

        /* Filter Chips */
        .filter-chips {
            display: none;
            flex-wrap: wrap;
            align-items: center;
            gap: 8px;
            margin-bottom: 16px;
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .filter-chip {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 14px;
            font-size: 14px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.15s;
        }

        .filter-chip .chip-label {
            pointer-events: none;
        }

        .filter-chip .chip-x {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 20px;
            margin: -4px -6px -4px 0;
            border-radius: 50%;
            background: rgba(0,0,0,0.1);
            transition: all 0.15s;
        }

        .filter-chip .chip-x:hover {
            background: rgba(0,0,0,0.25);
        }

        .filter-chip .chip-x svg {
            width: 12px;
            height: 12px;
            fill: currentColor;
            opacity: 0.8;
        }

        .filter-chip .chip-x:hover svg {
            opacity: 1;
        }

        .filter-chip.conclusion {
            background: var(--success-subtle);
            color: var(--success);
            border: 1px solid rgba(63, 185, 80, 0.3);
        }

        .filter-chip.type {
            background: var(--purple-subtle);
            color: var(--purple);
            border: 1px solid rgba(163, 113, 247, 0.3);
        }

        .filter-chip.component {
            background: var(--cyan-subtle);
            color: var(--cyan);
            border: 1px solid rgba(57, 197, 207, 0.3);
        }

        .filter-chip.exclude {
            background: var(--danger-subtle);
            color: var(--danger);
            border: 1px solid rgba(248, 81, 73, 0.3);
        }

        .filter-chip.exclude .chip-label {
            text-decoration: line-through;
        }

        .clear-filters-btn {
            padding: 4px 12px;
            font-size: 12px;
            background: var(--danger-subtle);
            color: var(--danger);
            border: 1px solid rgba(248, 81, 73, 0.3);
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.15s;
        }

        .clear-filters-btn:hover {
            background: var(--danger);
            color: white;
        }

        .legend-item.active {
            font-weight: 600;
        }

        .legend-item.exclude {
            text-decoration: line-through;
        }

        .chart-bar.active {
            box-shadow: 0 0 0 2px white;
        }

        .chart-bar.exclude {
            opacity: 0.4;
        }

        /* Stats Chart */
        .stats-chart {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
            padding: 16px;
            background: var(--bg-secondary);
            border-radius: 12px;
        }

        .chart-bars {
            display: flex;
            align-items: flex-end;
            gap: 4px;
            height: 60px;
            flex: 1;
        }

        .chart-bar {
            flex: 1;
            min-width: 20px;
            max-width: 60px;
            border-radius: 4px 4px 0 0;
            position: relative;
            cursor: pointer;
            transition: opacity 0.15s;
        }

        .chart-bar:hover {
            opacity: 0.8;
        }

        .chart-bar .bar-label {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            color: var(--text-secondary);
            white-space: nowrap;
            padding-bottom: 2px;
        }

        .chart-bar .bar-count {
            position: absolute;
            top: 4px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            font-weight: 600;
            color: #000;
        }

        .chart-legend {
            display: flex;
            flex-direction: column;
            gap: 4px;
            font-size: 11px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
        }

        .legend-dot {
            width: 8px;
            height: 8px;
            border-radius: 2px;
        }

        /* Slide Card */
        .slide {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 24px rgba(0,0,0,0.3), 0 0 0 1px rgba(255,255,255,0.03) inset;
        }

        .slide-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 24px;
            padding: 32px 36px;
            background: linear-gradient(180deg, var(--bg-tertiary) 0%, var(--bg-card) 100%);
            border-bottom: 1px solid var(--border-muted);
        }

        .bug-info { flex: 1; min-width: 0; }

        .bug-number {
            font-size: 15px;
            color: var(--text-secondary);
            font-weight: 600;
            margin-bottom: 6px;
        }

        .bug-title {
            font-size: 28px;
            font-weight: 700;
            color: var(--text-primary);
            line-height: 1.3;
            letter-spacing: -0.5px;
        }

        .bug-title a {
            color: inherit;
            text-decoration: none;
            transition: color 0.15s;
        }

        .bug-title a:hover { color: var(--accent); }

        .bug-meta {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-top: 16px;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 15px;
            color: var(--text-secondary);
        }

        .meta-item svg {
            width: 18px;
            height: 18px;
            fill: currentColor;
            opacity: 0.7;
        }

        .conclusion {
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 700;
            text-transform: capitalize;
            white-space: nowrap;
            letter-spacing: 0.3px;
        }

        .conclusion.reproduced { background: var(--success-subtle); color: var(--success); border: 1px solid rgba(63, 185, 80, 0.4); }
        .conclusion.cannot-reproduce { background: var(--danger-subtle); color: var(--danger); border: 1px solid rgba(248, 81, 73, 0.4); }
        .conclusion.not-reproduced { background: var(--danger-subtle); color: var(--danger); border: 1px solid rgba(248, 81, 73, 0.4); }
        .conclusion.needs-windows { background: var(--warning-subtle); color: var(--warning); border: 1px solid rgba(187, 128, 9, 0.4); }
        .conclusion.needs-azure { background: var(--warning-subtle); color: var(--warning); border: 1px solid rgba(187, 128, 9, 0.4); }
        .conclusion.needs-macos { background: var(--warning-subtle); color: var(--warning); border: 1px solid rgba(187, 128, 9, 0.4); }
        .conclusion.needs-vscode { background: var(--warning-subtle); color: var(--warning); border: 1px solid rgba(187, 128, 9, 0.4); }
        .conclusion.needs-k8s { background: var(--warning-subtle); color: var(--warning); border: 1px solid rgba(187, 128, 9, 0.4); }
        .conclusion.needs-visualstudio { background: var(--warning-subtle); color: var(--warning); border: 1px solid rgba(187, 128, 9, 0.4); }
        .conclusion.insufficient-info { background: var(--purple-subtle); color: var(--purple); border: 1px solid rgba(163, 113, 247, 0.4); }
        .conclusion.needs-info { background: var(--purple-subtle); color: var(--purple); border: 1px solid rgba(163, 113, 247, 0.4); }
        .conclusion.partial { background: var(--cyan-subtle); color: var(--cyan); border: 1px solid rgba(57, 197, 207, 0.4); }
        .conclusion.source-analysis { background: var(--purple-subtle); color: var(--purple); border: 1px solid rgba(163, 113, 247, 0.4); }

        /* Investigation Type Tags */
        .investigation-tags {
            display: flex;
            gap: 8px;
            margin-top: 14px;
        }

        .inv-tag {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 5px 12px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 600;
        }

        .inv-tag svg { width: 14px; height: 14px; fill: currentColor; }

        .inv-tag.repro {
            background: var(--success-subtle);
            color: var(--success);
            border: 1px solid rgba(63, 185, 80, 0.3);
        }

        .inv-tag.source {
            background: var(--purple-subtle);
            color: var(--purple);
            border: 1px solid rgba(163, 113, 247, 0.3);
        }

        .inv-tag.errors {
            background: var(--danger-subtle);
            color: var(--danger);
            border: 1px solid rgba(248, 81, 73, 0.3);
        }

        .inv-tag.env {
            background: var(--cyan-subtle);
            color: var(--cyan);
            border: 1px solid rgba(57, 197, 207, 0.3);
        }

        .inv-tag.full-repro {
            background: linear-gradient(135deg, var(--success-subtle) 0%, rgba(57, 197, 207, 0.2) 100%);
            color: var(--success);
            border: 1px solid rgba(63, 185, 80, 0.4);
            font-weight: 700;
        }

        .inv-tag.source-only {
            background: linear-gradient(135deg, var(--purple-subtle) 0%, rgba(68, 147, 248, 0.2) 100%);
            color: var(--purple);
            border: 1px solid rgba(163, 113, 247, 0.4);
            font-weight: 700;
        }

        /* Slide Body */
        .slide-body {
            padding: 32px 36px;
        }

        .section {
            margin-bottom: 28px;
        }

        .section:last-child { margin-bottom: 0; }

        .section-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 14px;
            font-size: 13px;
            font-weight: 700;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }

        .section-header svg {
            width: 16px;
            height: 16px;
            fill: currentColor;
        }

        .notes-text {
            font-size: 16px;
            color: var(--text-primary);
            line-height: 1.8;
            padding: 20px 24px;
            background: var(--bg-primary);
            border: 1px solid var(--border-muted);
            border-radius: 12px;
            border-left: 4px solid var(--accent);
        }

        .code-block {
            font-family: 'JetBrains Mono', 'SF Mono', Monaco, monospace;
            font-size: 13px;
            color: var(--text-secondary);
            background: var(--bg-primary);
            padding: 4px 10px;
            border-radius: 6px;
            border: 1px solid var(--border-muted);
        }

        /* Steps */
        .steps-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .step {
            background: var(--bg-primary);
            border: 1px solid var(--border-muted);
            border-radius: 12px;
            overflow: hidden;
        }

        .step-header {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 16px 20px;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-muted);
        }

        .step-number {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            background: var(--accent-emphasis);
            color: white;
            border-radius: 50%;
            font-size: 14px;
            font-weight: 700;
        }

        .step-description {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .step-content {
            padding: 16px 20px;
        }

        .step-command {
            font-family: 'JetBrains Mono', 'SF Mono', Monaco, monospace;
            font-size: 13px;
            color: var(--success);
            background: var(--bg-secondary);
            padding: 14px 18px;
            border-radius: 8px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-break: break-all;
            margin-bottom: 12px;
        }

        .step-command::before {
            content: '$ ';
            color: var(--text-tertiary);
        }

        .step-output {
            font-family: 'JetBrains Mono', 'SF Mono', Monaco, monospace;
            font-size: 12px;
            color: var(--text-secondary);
            background: var(--bg-secondary);
            padding: 14px 18px;
            border-radius: 8px;
            max-height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-break: break-all;
        }

        .step-file {
            margin-top: 12px;
        }

        .step-file-path {
            font-family: 'JetBrains Mono', 'SF Mono', Monaco, monospace;
            font-size: 13px;
            color: var(--accent);
            margin-bottom: 8px;
        }

        .step-file-content {
            font-family: 'JetBrains Mono', 'SF Mono', Monaco, monospace;
            font-size: 12px;
            color: var(--text-primary);
            background: var(--bg-secondary);
            padding: 14px 18px;
            border-radius: 8px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
            border-left: 3px solid var(--purple);
        }

        /* Two Column Layout */
        .two-columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
        }

        @media (max-width: 1100px) {
            .two-columns { grid-template-columns: 1fr; }
        }

        /* Source Investigation */
        .source-investigation {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px 24px;
        }

        .source-title {
            font-size: 14px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .source-title svg { width: 16px; height: 16px; fill: currentColor; }

        .file-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 16px;
        }

        .file-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
            padding: 12px 16px;
            background: var(--bg-primary);
            border: 1px solid var(--border-muted);
            border-radius: 8px;
        }

        .file-path {
            font-family: 'JetBrains Mono', 'SF Mono', Monaco, monospace;
            font-size: 13px;
            color: var(--accent);
        }

        .file-reason {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .bug-location {
            background: var(--bg-primary);
            border: 1px solid var(--border-muted);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 16px;
        }

        .bug-location-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-muted);
        }

        .bug-location-file {
            font-family: 'JetBrains Mono', 'SF Mono', Monaco, monospace;
            font-size: 13px;
            color: var(--accent);
        }

        .bug-location-lines {
            font-size: 12px;
            color: var(--text-tertiary);
            background: var(--bg-secondary);
            padding: 4px 10px;
            border-radius: 12px;
        }

        .bug-location-method {
            padding: 10px 16px;
            font-family: 'JetBrains Mono', 'SF Mono', Monaco, monospace;
            font-size: 13px;
            color: var(--warning);
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-muted);
        }

        .bug-location-code {
            padding: 16px;
            font-family: 'JetBrains Mono', 'SF Mono', Monaco, monospace;
            font-size: 12px;
            color: var(--text-primary);
            white-space: pre-wrap;
            overflow-x: auto;
            line-height: 1.6;
        }

        .root-cause, .proposed-fix {
            padding: 16px 20px;
            background: var(--bg-primary);
            border: 1px solid var(--border-muted);
            border-radius: 10px;
            margin-bottom: 12px;
        }

        .root-cause { border-left: 4px solid var(--danger); }
        .proposed-fix { border-left: 4px solid var(--success); }

        .cause-label {
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            margin-bottom: 8px;
        }

        .root-cause .cause-label { color: var(--danger); }
        .proposed-fix .cause-label { color: var(--success); }

        .cause-text {
            font-size: 14px;
            color: var(--text-primary);
            line-height: 1.7;
        }

        /* Error Messages */
        .error-block {
            background: var(--bg-primary);
            border: 1px solid var(--border-muted);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .error-header {
            padding: 12px 16px;
            background: var(--danger-subtle);
            border-bottom: 1px solid var(--border-muted);
            font-size: 13px;
            font-weight: 600;
            color: var(--danger);
        }

        .error-content {
            padding: 14px 16px;
            font-family: 'JetBrains Mono', 'SF Mono', Monaco, monospace;
            font-size: 12px;
            color: var(--text-secondary);
            white-space: pre-wrap;
            overflow-x: auto;
            max-height: 250px;
            overflow-y: auto;
        }

        .additional-errors {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .additional-error-item {
            padding: 12px 16px;
            background: var(--bg-primary);
            border: 1px solid var(--border-muted);
            border-left: 3px solid var(--warning);
            border-radius: 8px;
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        /* Environment */
        .env-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 12px;
        }

        .env-item {
            padding: 14px 18px;
            background: var(--bg-primary);
            border: 1px solid var(--border-muted);
            border-radius: 10px;
        }

        .env-label {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }

        .env-value {
            font-family: 'JetBrains Mono', 'SF Mono', Monaco, monospace;
            font-size: 13px;
            color: var(--text-primary);
            word-break: break-all;
        }

        .packages-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        .package-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: var(--purple-subtle);
            border: 1px solid rgba(163, 113, 247, 0.3);
            border-radius: 20px;
            font-size: 12px;
        }

        .package-name { color: var(--purple); font-weight: 600; }
        .package-version { color: var(--text-secondary); }

        /* Collapsible Sections */
        .collapsible {
            margin-bottom: 16px;
        }

        .collapsible-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 20px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .collapsible-header:hover {
            background: var(--bg-secondary);
        }

        .collapsible.open .collapsible-header {
            border-radius: 10px 10px 0 0;
            border-bottom: none;
        }

        .collapsible-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .collapsible-title svg { width: 18px; height: 18px; fill: currentColor; opacity: 0.7; }

        .collapsible-chevron {
            width: 20px;
            height: 20px;
            fill: var(--text-tertiary);
            transition: transform 0.2s;
        }

        .collapsible.open .collapsible-chevron {
            transform: rotate(180deg);
        }

        .collapsible-content {
            display: none;
            padding: 20px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-top: none;
            border-radius: 0 0 10px 10px;
        }

        .collapsible.open .collapsible-content {
            display: block;
        }

        /* Search Commands */
        .search-commands {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 16px;
        }

        .search-cmd {
            font-family: 'JetBrains Mono', 'SF Mono', Monaco, monospace;
            font-size: 12px;
            color: var(--success);
            background: var(--bg-primary);
            padding: 10px 14px;
            border-radius: 6px;
            border: 1px solid var(--border-muted);
        }

        .search-cmd::before {
            content: '$ ';
            color: var(--text-tertiary);
        }

        /* Navigation */
        .nav {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
            margin-top: 32px;
        }

        .nav-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 14px 28px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .nav-btn:hover:not(:disabled) {
            background: var(--bg-tertiary);
            border-color: var(--text-tertiary);
            transform: translateY(-1px);
        }

        .nav-btn:disabled {
            opacity: 0.35;
            cursor: not-allowed;
        }

        .nav-btn svg { width: 18px; height: 18px; fill: currentColor; }

        .page-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 24px;
            background: var(--bg-tertiary);
            border-radius: 12px;
            font-size: 18px;
            font-weight: 700;
            color: var(--text-secondary);
            font-variant-numeric: tabular-nums;
        }

        .page-indicator .current { color: var(--text-primary); }

        .kbd-hint {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
            color: var(--text-tertiary);
        }

        kbd {
            display: inline-block;
            padding: 4px 10px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 6px;
            font-family: 'SF Mono', Monaco, monospace;
            font-size: 13px;
            box-shadow: 0 2px 0 var(--border);
        }

        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 450px;
            gap: 20px;
            color: var(--text-secondary);
            font-size: 18px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        @media (max-width: 1000px) {
            .header { flex-direction: column; gap: 20px; align-items: flex-start; }
            .stats { width: 100%; flex-wrap: wrap; }
            .bug-title { font-size: 22px; }
            .app { padding: 24px 16px; }
            .slide-header { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="app">
        <header class="header">
            <div class="logo">
                <a href="index.html" class="home-link" title="Back to dashboards">‚Üê</a>
                <svg viewBox="0 0 16 16"><path d="M4.72.22a.75.75 0 011.06 0l1 1a.75.75 0 01-.018 1.042l-.054.054a3.5 3.5 0 015.067 5.067l.054-.054a.75.75 0 011.042-.018l1 1a.75.75 0 010 1.06l-1 1a.75.75 0 01-1.042.018l-.054-.054a3.5 3.5 0 01-5.067-5.067l-.054.054a.75.75 0 01-.018-1.042l-1-1a.75.75 0 010-1.06zm6.01 6.01a2 2 0 10-2.828-2.828 2 2 0 002.828 2.828zM4.47 10.47a.75.75 0 011.06 0L7 11.94l1.47-1.47a.75.75 0 111.06 1.06L8.06 13l1.47 1.47a.75.75 0 11-1.06 1.06L7 14.06l-1.47 1.47a.75.75 0 11-1.06-1.06L5.94 13l-1.47-1.47a.75.75 0 010-1.06z"/></svg>
                <h1>Bug Reproduction Dashboard</h1>
            </div>
            <div class="header-links">
                <a href="https://gist.githubusercontent.com/davidfowl/24575fd46c07064ec88cac9101bfa561/raw/results.json" target="_blank" class="raw-data-link">Raw JSON</a>
            </div>
            <div class="stats" id="stats"></div>
        </header>

        <p class="page-description">
            Results from <strong>Copilot CLI</strong> attempting to automatically reproduce bugs from the <a href="https://github.com/dotnet/aspire/issues" target="_blank">dotnet/aspire</a> issue tracker. Each issue was analyzed via source code investigation and/or full reproduction attempts in isolated environments.
            <button class="help-toggle" onclick="toggleHelp()">How to use ‚ñæ</button>
        </p>

        <div class="help-section" id="help-section" style="display: none;">
            <div class="help-grid">
                <div class="help-item">
                    <h3>üìä Stats Bar</h3>
                    <p>Shows total bugs being displayed, plus counts for <strong>Full Repro</strong> (ran actual code) vs <strong>Source Only</strong> (analyzed code without running).</p>
                </div>
                <div class="help-item">
                    <h3>üîç Search</h3>
                    <p>Type a bug number (e.g. "13792") to jump directly, or search by title/summary text. Results appear in a list view.</p>
                </div>
                <div class="help-item">
                    <h3>üìà Chart</h3>
                    <p>Visual breakdown by conclusion. <strong>Click a bar</strong> to filter to that conclusion. Bars show counts based on current filters.</p>
                </div>
                <div class="help-item">
                    <h3>üè∑Ô∏è Component Filters</h3>
                    <p>Filter by component (postgresql, redis, cli, etc.). <strong>Click to include</strong>, <strong>Shift+click to exclude</strong>. Multiple selections use OR logic.</p>
                </div>
                <div class="help-item">
                    <h3>üéØ Conclusion Filters</h3>
                    <p>Filter by result: reproduced, cannot-reproduce, needs-windows, etc. <strong>Click to include</strong>, <strong>Shift+click to exclude</strong>.</p>
                </div>
                <div class="help-item">
                    <h3>üíä Filter Chips</h3>
                    <p>Active filters appear as chips. <strong>Click chip</strong> to toggle include/exclude (strikethrough = exclude). <strong>Click ‚úï</strong> to remove.</p>
                </div>
                <div class="help-item">
                    <h3>‚å®Ô∏è Navigation</h3>
                    <p>Use <strong>‚Üê ‚Üí</strong> arrow keys or <strong>Space</strong> to navigate between bugs. URL hash updates for sharing.</p>
                </div>
                <div class="help-item">
                    <h3>üìã Bug Details</h3>
                    <p>Each bug shows summary, reproduction steps, source investigation, errors, and environment. <strong>Click section headers</strong> to collapse/expand.</p>
                </div>
            </div>
        </div>

        <div class="search-box" id="search-box" style="margin-bottom: 20px;">
            <svg class="search-icon" viewBox="0 0 16 16"><path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"/></svg>
            <input type="text" class="search-input" id="search-input" placeholder="Search bugs..." oninput="handleSearch(this.value)">
            <button class="search-clear" onclick="clearSearch()">
                <svg viewBox="0 0 16 16"><path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"/></svg>
            </button>
        </div>

        <div class="stats-chart" id="stats-chart"></div>
        <div class="component-filters" id="component-filters"></div>
        <div class="filters" id="filters"></div>
        <div class="filter-chips" id="filter-chips"></div>

        <div id="results-view" style="display:none">
            <div class="results-header">
                <span class="results-count" id="results-count"></span>
                <button class="results-back" onclick="clearSearch()">
                    <svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M9.78 12.78a.75.75 0 01-1.06 0L4.47 8.53a.75.75 0 010-1.06l4.25-4.25a.751.751 0 011.042.018.751.751 0 01.018 1.042L6.06 8l3.72 3.72a.75.75 0 010 1.06z"/></svg>
                    Back to slides
                </button>
            </div>
            <div class="results-list" id="results-list"></div>
        </div>

        <div id="slide-view">
            <div class="slide" id="slide">
                <div class="loading">
                    <div class="spinner"></div>
                    <span>Loading bug data...</span>
                </div>
            </div>

            <nav class="nav">
                <button class="nav-btn" id="prev" onclick="prev()">
                    <svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M9.78 12.78a.75.75 0 01-1.06 0L4.47 8.53a.75.75 0 010-1.06l4.25-4.25a.751.751 0 011.042.018.751.751 0 01.018 1.042L6.06 8l3.72 3.72a.75.75 0 010 1.06z"/></svg>
                    Previous
                </button>
                <div class="page-indicator" id="page">
                    <span class="current">1</span> / <span>1</span>
                </div>
                <button class="nav-btn" id="next" onclick="next()">
                    Next
                    <svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M6.22 3.22a.75.75 0 011.06 0l4.25 4.25a.75.75 0 010 1.06l-4.25 4.25a.751.751 0 01-1.042-.018.751.751 0 01-.018-1.042L9.94 8 6.22 4.28a.75.75 0 010-1.06z"/></svg>
                </button>
            </nav>

        <div class="kbd-hint">
            Press <kbd>‚Üê</kbd> <kbd>‚Üí</kbd> or <kbd>Space</kbd> to navigate
        </div>
    </div>

    <script>
        const URL = 'https://gist.githubusercontent.com/davidfowl/24575fd46c07064ec88cac9101bfa561/raw/results.json';
        let data, filtered = [], idx = 0;
        
        // Multi-select filter state - each can be 'include' or 'exclude'
        let conclusionFilters = {};  // e.g., { 'reproduced': 'include', 'cannot-reproduce': 'exclude' }
        let typeFilters = {};        // e.g., { 'full-repro': 'include' }
        let componentFilters = {};   // e.g., { 'postgresql': 'include', 'cli': 'exclude' }

        async function load() {
            data = await (await fetch(URL)).json();
            filtered = data.investigations;
            // Check hash before initial render
            const hash = window.location.hash.slice(1);
            if (hash) {
                const bugId = parseInt(hash, 10);
                const index = filtered.findIndex(r => r.bugId === bugId);
                if (index !== -1) idx = index;
            }
            renderStats();
            renderStatsChart();
            renderComponentFilters();
            renderFilters();
            renderFilterChips();
            render();
        }

        // Helper to determine if investigation is source-only based on notes
        function isSourceAnalysisOnly(r) {
            // If it has repro steps, it's not source-only
            if (r.reproductionSteps?.length) return false;
            
            const notes = (r.notes || '').toLowerCase();
            return notes.includes('source code analysis') || 
                   notes.includes('via source analysis') ||
                   notes.includes('reproduced via source') ||
                   (r.sourceCodeInvestigation && !r.reproductionSteps?.length);
        }

        function isFullRepro(r) {
            return r.reproductionSteps?.length && r.sourceCodeInvestigation;
        }

        function isStepsOnly(r) {
            return r.reproductionSteps?.length && !r.sourceCodeInvestigation;
        }

        // Extract component from investigation
        function getComponent(r) {
            const title = (r.title || '').toLowerCase();
            const file = r.sourceCodeInvestigation?.bugLocation?.file || '';
            
            // Check title for known components
            const componentPatterns = [
                [/postgresql|postgres/i, 'postgresql'],
                [/redis|garnet|valkey/i, 'redis'],
                [/azure|cosmos|eventhubs|servicebus/i, 'azure'],
                [/mysql/i, 'mysql'],
                [/mongodb/i, 'mongodb'],
                [/rabbitmq/i, 'rabbitmq'],
                [/kafka/i, 'kafka'],
                [/docker|container/i, 'docker'],
                [/orleans/i, 'orleans'],
                [/dapr/i, 'dapr'],
                [/nats/i, 'nats'],
                [/oracle/i, 'oracle'],
                [/sqlserver|sql server/i, 'sqlserver'],
                [/seq/i, 'seq'],
                [/grafana/i, 'grafana'],
                [/yarp/i, 'yarp'],
                [/keycloak/i, 'keycloak'],
            ];
            
            for (const [pattern, name] of componentPatterns) {
                if (pattern.test(title)) return name;
            }
            
            // Check file path
            if (file.includes('Dashboard')) return 'dashboard';
            if (file.includes('Cli')) return 'cli';
            if (file.includes('Hosting')) return 'hosting';
            
            return 'other';
        }

        let componentFilter = 'all';

        function renderStatsChart() {
            const conclusions = {};
            data.investigations.forEach(r => {
                conclusions[r.conclusion] = (conclusions[r.conclusion] || 0) + 1;
            });
            
            const sorted = Object.entries(conclusions).sort((a, b) => b[1] - a[1]);
            const maxCount = Math.max(...Object.values(conclusions));
            
            const colors = {
                'reproduced': 'var(--success)',
                'cannot-reproduce': 'var(--danger)',
                'needs-windows': 'var(--warning)',
                'needs-azure': 'var(--warning)',
                'needs-macos': 'var(--warning)',
                'needs-vscode': 'var(--warning)',
                'needs-k8s': 'var(--warning)',
                'needs-visualstudio': 'var(--warning)',
                'insufficient-info': 'var(--purple)',
                'source-analysis': 'var(--purple)',
            };
            
            const barsHtml = sorted.map(([conclusion, count]) => {
                const height = Math.max(10, (count / maxCount) * 100);
                const color = colors[conclusion] || 'var(--accent)';
                const mode = conclusionFilters[conclusion];
                const cls = mode === 'include' ? 'active' : mode === 'exclude' ? 'active exclude' : '';
                return `
                    <div class="chart-bar ${cls}" style="height:${height}%;background:${color}" onclick="toggleConclusionFilter('${conclusion}', event)" title="${conclusion}: ${count}">
                        ${count > 5 ? `<span class="bar-count">${count}</span>` : ''}
                    </div>
                `;
            }).join('');
            
            const legendHtml = sorted.slice(0, 6).map(([conclusion, count]) => {
                const color = colors[conclusion] || 'var(--accent)';
                const mode = conclusionFilters[conclusion];
                const cls = mode === 'include' ? 'active' : mode === 'exclude' ? 'active exclude' : '';
                return `<div class="legend-item ${cls}" onclick="toggleConclusionFilter('${conclusion}', event)"><span class="legend-dot" style="background:${color}"></span>${conclusion.replace(/-/g, ' ')} (${count})</div>`;
            }).join('');
            
            document.getElementById('stats-chart').innerHTML = `
                <div class="chart-bars">${barsHtml}</div>
                <div class="chart-legend">${legendHtml}</div>
            `;
        }

        function renderComponentFilters() {
            // Get base set after applying conclusion and type filters
            let base = data.investigations;
            const concIncludes = Object.entries(conclusionFilters).filter(([_, m]) => m === 'include').map(([k]) => k);
            const concExcludes = Object.entries(conclusionFilters).filter(([_, m]) => m === 'exclude').map(([k]) => k);
            if (concIncludes.length > 0) {
                base = base.filter(r => concIncludes.includes(r.conclusion));
            }
            if (concExcludes.length > 0) {
                base = base.filter(r => !concExcludes.includes(r.conclusion));
            }
            
            const typeIncludes = Object.entries(typeFilters).filter(([_, m]) => m === 'include').map(([k]) => k);
            const typeExcludes = Object.entries(typeFilters).filter(([_, m]) => m === 'exclude').map(([k]) => k);
            if (typeIncludes.length > 0) {
                base = base.filter(r => {
                    if (typeIncludes.includes('full-repro') && isFullRepro(r)) return true;
                    if (typeIncludes.includes('source-only') && isSourceAnalysisOnly(r)) return true;
                    if (typeIncludes.includes('steps-only') && isStepsOnly(r)) return true;
                    return false;
                });
            }
            if (typeExcludes.length > 0) {
                base = base.filter(r => {
                    if (typeExcludes.includes('full-repro') && isFullRepro(r)) return false;
                    if (typeExcludes.includes('source-only') && isSourceAnalysisOnly(r)) return false;
                    if (typeExcludes.includes('steps-only') && isStepsOnly(r)) return false;
                    return true;
                });
            }
            
            const components = {};
            base.forEach(r => {
                const comp = getComponent(r);
                components[comp] = (components[comp] || 0) + 1;
            });
            
            // Get all components from full data for ordering
            const allComponents = {};
            data.investigations.forEach(r => {
                const comp = getComponent(r);
                allComponents[comp] = (allComponents[comp] || 0) + 1;
            });
            
            const sorted = Object.entries(allComponents)
                .filter(([_, count]) => count >= 2)
                .sort((a, b) => b[1] - a[1]);
            
            const html = sorted.map(([comp]) => {
                const count = components[comp] || 0;
                const mode = componentFilters[comp];
                const cls = mode === 'include' ? 'active' : mode === 'exclude' ? 'active exclude' : '';
                return `<button class="component-btn ${cls}" onclick="toggleComponentFilter('${comp}', event)">${comp} (${count})</button>`;
            }).join('');
            
            document.getElementById('component-filters').innerHTML = html;
        }

        // Toggle filter: click = include, shift+click = exclude, click again = remove
        function toggleComponentFilter(comp, event) {
            const current = componentFilters[comp];
            const isShift = event && event.shiftKey;
            
            if (!current) {
                componentFilters[comp] = isShift ? 'exclude' : 'include';
            } else if (current === 'include' && isShift) {
                componentFilters[comp] = 'exclude';
            } else if (current === 'exclude' && !isShift) {
                componentFilters[comp] = 'include';
            } else {
                delete componentFilters[comp];
            }
            renderAll();
        }

        function toggleConclusionFilter(conclusion, event) {
            const current = conclusionFilters[conclusion];
            const isShift = event && event.shiftKey;
            
            if (!current) {
                conclusionFilters[conclusion] = isShift ? 'exclude' : 'include';
            } else if (current === 'include' && isShift) {
                conclusionFilters[conclusion] = 'exclude';
            } else if (current === 'exclude' && !isShift) {
                conclusionFilters[conclusion] = 'include';
            } else {
                delete conclusionFilters[conclusion];
            }
            renderAll();
        }

        function toggleTypeFilter(type, event) {
            const current = typeFilters[type];
            const isShift = event && event.shiftKey;
            
            // Single-select for type: clear others first
            if (!current) {
                typeFilters = {};
                typeFilters[type] = isShift ? 'exclude' : 'include';
            } else if (current === 'include' && isShift) {
                typeFilters[type] = 'exclude';
            } else if (current === 'exclude' && !isShift) {
                typeFilters[type] = 'include';
            } else {
                delete typeFilters[type];
            }
            renderAll();
        }

        function clearAllFilters() {
            conclusionFilters = {};
            typeFilters = {};
            componentFilters = {};
            renderAll();
        }

        function removeFilter(group, value, event) {
            if (event) event.stopPropagation();
            if (group === 'conclusion') {
                delete conclusionFilters[value];
            } else if (group === 'type') {
                delete typeFilters[value];
            } else if (group === 'component') {
                delete componentFilters[value];
            }
            renderAll();
        }

        function toggleChipMode(group, value) {
            if (group === 'conclusion') {
                conclusionFilters[value] = conclusionFilters[value] === 'include' ? 'exclude' : 'include';
            } else if (group === 'type') {
                typeFilters[value] = typeFilters[value] === 'include' ? 'exclude' : 'include';
            } else if (group === 'component') {
                componentFilters[value] = componentFilters[value] === 'include' ? 'exclude' : 'include';
            }
            renderAll();
        }

        function hasActiveFilters() {
            return Object.keys(conclusionFilters).length > 0 || Object.keys(typeFilters).length > 0 || Object.keys(componentFilters).length > 0;
        }

        function renderFilterChips() {
            if (!hasActiveFilters()) {
                document.getElementById('filter-chips').style.display = 'none';
                return;
            }
            
            document.getElementById('filter-chips').style.display = 'flex';
            
            const chips = [];
            
            const xIcon = `<span class="chip-x" onclick="removeFilter('GROUP', 'VALUE', event)"><svg viewBox="0 0 16 16"><path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"/></svg></span>`;
            
            Object.entries(conclusionFilters).forEach(([f, mode]) => {
                const cls = mode === 'exclude' ? 'exclude' : 'conclusion';
                const x = xIcon.replace('GROUP', 'conclusion').replace('VALUE', f);
                chips.push(`<span class="filter-chip ${cls}" onclick="toggleChipMode('conclusion', '${f}')"><span class="chip-label">${f.replace(/-/g, ' ')}</span>${x}</span>`);
            });
            
            Object.entries(typeFilters).forEach(([f, mode]) => {
                const label = f === 'full-repro' ? 'Full Repro' : f === 'source-only' ? 'Source Only' : 'Steps Only';
                const cls = mode === 'exclude' ? 'exclude' : 'type';
                const x = xIcon.replace('GROUP', 'type').replace('VALUE', f);
                chips.push(`<span class="filter-chip ${cls}" onclick="toggleChipMode('type', '${f}')"><span class="chip-label">${label}</span>${x}</span>`);
            });
            
            Object.entries(componentFilters).forEach(([f, mode]) => {
                const cls = mode === 'exclude' ? 'exclude' : 'component';
                const x = xIcon.replace('GROUP', 'component').replace('VALUE', f);
                chips.push(`<span class="filter-chip ${cls}" onclick="toggleChipMode('component', '${f}')"><span class="chip-label">${f}</span>${x}</span>`);
            });
            
            chips.push(`<button class="clear-filters-btn" onclick="clearAllFilters()">Clear All</button>`);
            
            document.getElementById('filter-chips').innerHTML = chips.join('');
        }

        function applyFilters() {
            idx = 0;
            let result = data.investigations;
            
            // Apply component filters
            const compIncludes = Object.entries(componentFilters).filter(([_, m]) => m === 'include').map(([k]) => k);
            const compExcludes = Object.entries(componentFilters).filter(([_, m]) => m === 'exclude').map(([k]) => k);
            if (compIncludes.length > 0) {
                result = result.filter(r => compIncludes.includes(getComponent(r)));
            }
            if (compExcludes.length > 0) {
                result = result.filter(r => !compExcludes.includes(getComponent(r)));
            }
            
            // Apply conclusion filters
            const concIncludes = Object.entries(conclusionFilters).filter(([_, m]) => m === 'include').map(([k]) => k);
            const concExcludes = Object.entries(conclusionFilters).filter(([_, m]) => m === 'exclude').map(([k]) => k);
            if (concIncludes.length > 0) {
                result = result.filter(r => concIncludes.includes(r.conclusion));
            }
            if (concExcludes.length > 0) {
                result = result.filter(r => !concExcludes.includes(r.conclusion));
            }
            
            // Apply type filters
            const typeIncludes = Object.entries(typeFilters).filter(([_, m]) => m === 'include').map(([k]) => k);
            const typeExcludes = Object.entries(typeFilters).filter(([_, m]) => m === 'exclude').map(([k]) => k);
            if (typeIncludes.length > 0) {
                result = result.filter(r => {
                    if (typeIncludes.includes('full-repro') && isFullRepro(r)) return true;
                    if (typeIncludes.includes('source-only') && isSourceAnalysisOnly(r)) return true;
                    if (typeIncludes.includes('steps-only') && isStepsOnly(r)) return true;
                    return false;
                });
            }
            if (typeExcludes.length > 0) {
                result = result.filter(r => {
                    if (typeExcludes.includes('full-repro') && isFullRepro(r)) return false;
                    if (typeExcludes.includes('source-only') && isSourceAnalysisOnly(r)) return false;
                    if (typeExcludes.includes('steps-only') && isStepsOnly(r)) return false;
                    return true;
                });
            }
            
            filtered = result;
            render();
        }

        function renderAll() {
            applyFilters();
            renderStats();
            renderFilters();
            renderComponentFilters();
            renderStatsChart();
            renderFilterChips();
        }

        function renderStats() {
            const total = data.investigations.length;
            
            // Investigation type counts
            const fullRepro = filtered.filter(isFullRepro).length;
            const sourceOnly = filtered.filter(isSourceAnalysisOnly).length;
            const stepsOnly = filtered.filter(isStepsOnly).length;
            
            document.getElementById('stats').innerHTML = `
                <div class="stat"><span class="stat-value">${filtered.length}</span><span class="stat-label">Showing</span></div>
                <div class="stat"><span class="stat-value success">${fullRepro}</span><span class="stat-label">Full Repro</span></div>
                <div class="stat"><span class="stat-value" style="color:var(--purple)">${sourceOnly}</span><span class="stat-label">Source Only</span></div>
                <div class="stat"><span class="stat-value" style="color:var(--cyan)">${stepsOnly}</span><span class="stat-label">Steps Only</span></div>
            `;
        }

        function renderFilters() {
            const conclusions = [...new Set(data.investigations.map(r => r.conclusion))];
            
            // Count based on current filtered results (excluding the conclusion filter itself to show potential additions)
            const getFilteredCount = (c) => {
                // Apply component and type filters, then count for this conclusion
                let base = data.investigations;
                const compIncludes = Object.entries(componentFilters).filter(([_, m]) => m === 'include').map(([k]) => k);
                const compExcludes = Object.entries(componentFilters).filter(([_, m]) => m === 'exclude').map(([k]) => k);
                if (compIncludes.length > 0) {
                    base = base.filter(r => compIncludes.includes(getComponent(r)));
                }
                if (compExcludes.length > 0) {
                    base = base.filter(r => !compExcludes.includes(getComponent(r)));
                }
                
                const typeIncludes = Object.entries(typeFilters).filter(([_, m]) => m === 'include').map(([k]) => k);
                const typeExcludes = Object.entries(typeFilters).filter(([_, m]) => m === 'exclude').map(([k]) => k);
                if (typeIncludes.length > 0) {
                    base = base.filter(r => {
                        if (typeIncludes.includes('full-repro') && isFullRepro(r)) return true;
                        if (typeIncludes.includes('source-only') && isSourceAnalysisOnly(r)) return true;
                        if (typeIncludes.includes('steps-only') && isStepsOnly(r)) return true;
                        return false;
                    });
                }
                if (typeExcludes.length > 0) {
                    base = base.filter(r => {
                        if (typeExcludes.includes('full-repro') && isFullRepro(r)) return false;
                        if (typeExcludes.includes('source-only') && isSourceAnalysisOnly(r)) return false;
                        if (typeExcludes.includes('steps-only') && isStepsOnly(r)) return false;
                        return true;
                    });
                }
                return base.filter(r => r.conclusion === c).length;
            };
            
            // Type counts based on component + conclusion filters
            const getTypeCount = (typeFn) => {
                let base = data.investigations;
                const compIncludes = Object.entries(componentFilters).filter(([_, m]) => m === 'include').map(([k]) => k);
                const compExcludes = Object.entries(componentFilters).filter(([_, m]) => m === 'exclude').map(([k]) => k);
                if (compIncludes.length > 0) {
                    base = base.filter(r => compIncludes.includes(getComponent(r)));
                }
                if (compExcludes.length > 0) {
                    base = base.filter(r => !compExcludes.includes(getComponent(r)));
                }
                
                const concIncludes = Object.entries(conclusionFilters).filter(([_, m]) => m === 'include').map(([k]) => k);
                const concExcludes = Object.entries(conclusionFilters).filter(([_, m]) => m === 'exclude').map(([k]) => k);
                if (concIncludes.length > 0) {
                    base = base.filter(r => concIncludes.includes(r.conclusion));
                }
                if (concExcludes.length > 0) {
                    base = base.filter(r => !concExcludes.includes(r.conclusion));
                }
                return base.filter(typeFn).length;
            };
            
            const fullReproCount = getTypeCount(isFullRepro);
            const sourceOnlyCount = getTypeCount(isSourceAnalysisOnly);
            const stepsOnlyCount = getTypeCount(isStepsOnly);
            
            const conclusionBtns = conclusions.map(c => {
                const mode = conclusionFilters[c];
                const cls = mode === 'include' ? 'active' : mode === 'exclude' ? 'active exclude' : '';
                return `<button class="filter-btn ${cls}" onclick="toggleConclusionFilter('${c}', event)">${c.replace(/-/g, ' ')} (${getFilteredCount(c)})</button>`;
            }).join('');
            
            const getTypeClass = (t) => {
                const mode = typeFilters[t];
                return mode === 'include' ? 'active' : mode === 'exclude' ? 'active exclude' : '';
            };
            
            const typeBtns = `
                <span style="width:1px;height:24px;background:var(--border);margin:0 8px"></span>
                <button class="filter-btn ${getTypeClass('full-repro')}" onclick="toggleTypeFilter('full-repro', event)">Full Repro (${fullReproCount})</button>
                <button class="filter-btn ${getTypeClass('source-only')}" onclick="toggleTypeFilter('source-only', event)">Source Only (${sourceOnlyCount})</button>
                <button class="filter-btn ${getTypeClass('steps-only')}" onclick="toggleTypeFilter('steps-only', event)">Steps Only (${stepsOnlyCount})</button>
            `;
            
            document.getElementById('filters').innerHTML = conclusionBtns + typeBtns;
        }

        function formatDate(timestamp) {
            if (!timestamp) return '';
            const date = new Date(timestamp);
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        }

        function escapeHtml(str) {
            if (!str) return '';
            return str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
        }

        let searchQuery = '';
        let searchResults = [];

        function handleSearch(query) {
            searchQuery = query.trim().toLowerCase();
            const searchBox = document.getElementById('search-box');
            
            if (!searchQuery) {
                searchBox.classList.remove('has-value');
                showSlideView();
                return;
            }
            
            searchBox.classList.add('has-value');
            
            // Check if it's an exact bug ID (with or without #)
            const idMatch = searchQuery.match(/^#?(\d+)$/);
            if (idMatch) {
                const bugId = parseInt(idMatch[1]);
                const found = data.investigations.find(r => r.bugId === bugId);
                if (found) {
                    clearSearch();
                    goToBug(bugId);
                    return;
                }
            }
            
            performSearch();
            showResultsView();
        }

        function clearSearch() {
            searchQuery = '';
            document.getElementById('search-input').value = '';
            document.getElementById('search-box').classList.remove('has-value');
            showSlideView();
        }

        function toggleHelp() {
            const helpSection = document.getElementById('help-section');
            const toggle = document.querySelector('.help-toggle');
            if (helpSection.style.display === 'none') {
                helpSection.style.display = 'block';
                toggle.textContent = 'How to use ‚ñ¥';
            } else {
                helpSection.style.display = 'none';
                toggle.textContent = 'How to use ‚ñæ';
            }
        }

        function performSearch() {
            searchResults = data.investigations.filter(r => {
                const searchIn = [
                    String(r.bugId),
                    r.title,
                    r.notes,
                    r.conclusion,
                    r.sourceCodeInvestigation?.rootCause,
                    r.sourceCodeInvestigation?.proposedFix,
                    r.sourceCodeInvestigation?.bugLocation?.file,
                    r.errorMessages?.primaryError,
                    ...(r.sourceCodeInvestigation?.relevantFiles?.map(f => f.path) || [])
                ].filter(Boolean).join(' ').toLowerCase();
                
                return searchIn.includes(searchQuery);
            });
        }

        function showResultsView() {
            document.getElementById('slide-view').style.display = 'none';
            document.getElementById('results-view').style.display = 'block';
            renderResults();
        }

        function showSlideView() {
            document.getElementById('results-view').style.display = 'none';
            document.getElementById('slide-view').style.display = 'block';
        }

        function renderResults() {
            document.getElementById('results-count').textContent = `${searchResults.length} result${searchResults.length !== 1 ? 's' : ''} found`;
            
            if (!searchResults.length) {
                document.getElementById('results-list').innerHTML = '<div class="loading">No bugs match your search</div>';
                return;
            }

            document.getElementById('results-list').innerHTML = searchResults.map(r => {
                let tagHtml = '';
                if (isFullRepro(r)) {
                    tagHtml = '<span class="result-tag full">Full</span>';
                } else if (isSourceAnalysisOnly(r)) {
                    tagHtml = '<span class="result-tag source">Source</span>';
                } else if (isStepsOnly(r)) {
                    tagHtml = '<span class="result-tag steps">Steps</span>';
                }

                return `
                    <div class="result-item" onclick="selectResult(${r.bugId})">
                        <span class="result-bug-id">#${r.bugId}</span>
                        <span class="result-title">${escapeHtml(r.title)}</span>
                        <div class="result-tags">${tagHtml}</div>
                        <span class="result-conclusion ${r.conclusion}">${r.conclusion.replace(/-/g, ' ')}</span>
                    </div>
                `;
            }).join('');
        }

        function selectResult(bugId) {
            clearSearch();
            goToBug(bugId);
        }

        function render() {
            if (!filtered.length) {
                document.getElementById('slide').innerHTML = '<div class="loading">No bugs match this filter</div>';
                updateNav();
                return;
            }

            const r = filtered[idx];
            const hasSteps = r.reproductionSteps && r.reproductionSteps.length > 0;
            const hasSourceInvestigation = r.sourceCodeInvestigation;
            const hasErrors = r.errorMessages;
            const hasEnv = r.environment;

            document.getElementById('slide').innerHTML = `
                <div class="slide-header">
                    <div class="bug-info">
                        <div class="bug-number">#${r.bugId}</div>
                        <div class="bug-title"><a href="${r.url}" target="_blank">${escapeHtml(r.title)}</a></div>
                        <div class="bug-meta">
                            <span class="meta-item">
                                <svg viewBox="0 0 16 16"><path d="M1.5 14.25c0 .138.112.25.25.25H4v-1.25a.75.75 0 01.75-.75h2.5a.75.75 0 01.75.75v1.25h2.25a.25.25 0 00.25-.25V1.75a.25.25 0 00-.25-.25h-8.5a.25.25 0 00-.25.25v12.5zM1.75 16A1.75 1.75 0 010 14.25V1.75C0 .784.784 0 1.75 0h8.5C11.216 0 12 .784 12 1.75v12.5c0 .085-.006.168-.018.25h2.268a.25.25 0 00.25-.25V8.285a.25.25 0 00-.111-.208l-1.055-.703a.749.749 0 11.832-1.248l1.055.703c.487.325.779.871.779 1.456v5.965A1.75 1.75 0 0114.25 16h-3.5a.766.766 0 01-.197-.026c-.099.017-.2.026-.303.026h-3a.75.75 0 01-.75-.75V14h-1v1.25a.75.75 0 01-.75.75h-3zM3 3.75A.75.75 0 013.75 3h.5a.75.75 0 010 1.5h-.5A.75.75 0 013 3.75zM3.75 6h.5a.75.75 0 010 1.5h-.5a.75.75 0 010-1.5zM3 9.75A.75.75 0 013.75 9h.5a.75.75 0 010 1.5h-.5A.75.75 0 013 9.75zM7.75 3h.5a.75.75 0 010 1.5h-.5a.75.75 0 010-1.5zM7 6.75A.75.75 0 017.75 6h.5a.75.75 0 010 1.5h-.5A.75.75 0 017 6.75zM7.75 9h.5a.75.75 0 010 1.5h-.5a.75.75 0 010-1.5z"/></svg>
                                ${formatDate(r.timestamp)}
                            </span>
                            ${r.reproductionTime ? `<span class="meta-item">
                                <svg viewBox="0 0 16 16"><path d="M5.75.75A.75.75 0 016.5 0h3a.75.75 0 010 1.5h-.75v1l-.001.041a6.5 6.5 0 11-4.75-1.54V.75a.75.75 0 01.751-.75zm.936 3.5A5 5 0 108 13a5 5 0 00-1.314-8.75zm2.564 4.5a.75.75 0 01-.75.75H6.75a.75.75 0 010-1.5h1v-2.25a.75.75 0 011.5 0z"/></svg>
                                ${r.reproductionTime}
                            </span>` : ''}
                            ${r.testProjectLocation ? `<span class="meta-item">
                                <svg viewBox="0 0 16 16"><path d="M1.75 1A1.75 1.75 0 000 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0016 13.25v-8.5A1.75 1.75 0 0014.25 3H7.5a.25.25 0 01-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75z"/></svg>
                                <code class="code-block">${r.testProjectLocation}</code>
                            </span>` : ''}
                        </div>
                        <div class="investigation-tags">
                            ${isFullRepro(r) ? `<span class="inv-tag full-repro" onclick="toggleTypeFilter('full-repro', event)" style="cursor:pointer" title="Click to filter by Full Repro"><svg viewBox="0 0 16 16"><path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM6.79 5.093A.75.75 0 0 0 5.5 5.75v4.5a.75.75 0 0 0 1.29.53l2.25-2.25a.75.75 0 0 0 0-1.06Z"/></svg>Full Repro</span>` : 
                              (isSourceAnalysisOnly(r) ? `<span class="inv-tag source-only" onclick="toggleTypeFilter('source-only', event)" style="cursor:pointer" title="Click to filter by Source Analysis"><svg viewBox="0 0 16 16"><path d="M4.72 3.22a.75.75 0 011.06 1.06L2.06 8l3.72 3.72a.75.75 0 11-1.06 1.06L.47 8.53a.75.75 0 010-1.06l4.25-4.25zm6.56 0a.75.75 0 10-1.06 1.06L13.94 8l-3.72 3.72a.75.75 0 101.06 1.06l4.25-4.25a.75.75 0 000-1.06l-4.25-4.25z"/></svg>Source Analysis Only</span>` : 
                              (isStepsOnly(r) ? `<span class="inv-tag repro" onclick="toggleTypeFilter('steps-only', event)" style="cursor:pointer" title="Click to filter by Repro Steps"><svg viewBox="0 0 16 16"><path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm4.879-2.773 4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559V5.442a.25.25 0 0 1 .379-.215Z"/></svg>Repro Steps</span>` : ''))}
                            ${hasErrors ? `<span class="inv-tag errors"><svg viewBox="0 0 16 16"><path d="M4.47.22A.749.749 0 015 0h6c.199 0 .389.079.53.22l4.25 4.25c.141.14.22.331.22.53v6a.749.749 0 01-.22.53l-4.25 4.25A.749.749 0 0111 16H5a.749.749 0 01-.53-.22L.22 11.53A.749.749 0 010 11V5c0-.199.079-.389.22-.53Zm.84 1.28L1.5 5.31v5.38l3.81 3.81h5.38l3.81-3.81V5.31L10.69 1.5ZM8 4a.75.75 0 01.75.75v3.5a.75.75 0 01-1.5 0v-3.5A.75.75 0 018 4zm0 8a1 1 0 100-2 1 1 0 000 2z"/></svg>Error Logs</span>` : ''}
                            ${hasEnv ? `<span class="inv-tag env"><svg viewBox="0 0 16 16"><path d="M.5 4V2.5c0-.55.45-1 1-1H3a.5.5 0 010 1H1.5V4a.5.5 0 01-1 0zM.5 12v1.5c0 .55.45 1 1 1H3a.5.5 0 010-1H1.5V12a.5.5 0 00-1 0zM12.5 4V2.5H11a.5.5 0 010-1h1.5c.55 0 1 .45 1 1V4a.5.5 0 01-1 0zM12.5 12v1.5H11a.5.5 0 010 1h1.5c.55 0 1-.45 1-1V12a.5.5 0 00-1 0z"/></svg>Environment</span>` : ''}
                        </div>
                    </div>
                    <div class="conclusion ${r.conclusion}" onclick="toggleConclusionFilter('${r.conclusion}', event)" style="cursor:pointer" title="Click to filter by ${r.conclusion.replace(/-/g, ' ')}">${r.conclusion.replace(/-/g, ' ')}</div>
                </div>
                <div class="slide-body">
                    <!-- Notes Section -->
                    <div class="section">
                        <div class="section-header">
                            <svg viewBox="0 0 16 16"><path d="M0 3.75C0 2.784.784 2 1.75 2h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0114.25 14H1.75A1.75 1.75 0 010 12.25Zm1.75-.25a.25.25 0 00-.25.25v8.5c0 .138.112.25.25.25h12.5a.25.25 0 00.25-.25v-8.5a.25.25 0 00-.25-.25ZM3.5 6.25a.75.75 0 01.75-.75h7a.75.75 0 010 1.5h-7a.75.75 0 01-.75-.75Zm.75 2.25h4a.75.75 0 010 1.5h-4a.75.75 0 010-1.5Z"/></svg>
                            Summary
                        </div>
                        <div class="notes-text">${escapeHtml(r.notes)}</div>
                    </div>

                    <!-- Environment Section -->
                    ${hasEnv ? `
                    <div class="collapsible open">
                        <div class="collapsible-header" onclick="this.parentElement.classList.toggle('open')">
                            <div class="collapsible-title">
                                <svg viewBox="0 0 16 16"><path d="M.5 4V2.5c0-.55.45-1 1-1H3a.5.5 0 010 1H1.5V4a.5.5 0 01-1 0zM.5 12v1.5c0 .55.45 1 1 1H3a.5.5 0 010-1H1.5V12a.5.5 0 00-1 0zM12.5 4V2.5H11a.5.5 0 010-1h1.5c.55 0 1 .45 1 1V4a.5.5 0 01-1 0zM12.5 12v1.5H11a.5.5 0 010 1h1.5c.55 0 1-.45 1-1V12a.5.5 0 00-1 0zM8 5.25a2.25 2.25 0 100 4.5 2.25 2.25 0 000-4.5z"/></svg>
                                Environment
                            </div>
                            <svg class="collapsible-chevron" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M12.78 6.22a.75.75 0 010 1.06l-4.25 4.25a.75.75 0 01-1.06 0L3.22 7.28a.75.75 0 011.06-1.06L8 9.94l3.72-3.72a.75.75 0 011.06 0z"/></svg>
                        </div>
                        <div class="collapsible-content">
                            <div class="env-grid">
                                ${r.environment.os ? `<div class="env-item"><div class="env-label">Operating System</div><div class="env-value">${escapeHtml(r.environment.os)}</div></div>` : ''}
                                ${r.environment.dotnetVersion ? `<div class="env-item"><div class="env-label">.NET Version</div><div class="env-value">${r.environment.dotnetVersion}</div></div>` : ''}
                                ${r.environment.aspireVersion ? `<div class="env-item"><div class="env-label">Aspire Version</div><div class="env-value">${r.environment.aspireVersion}</div></div>` : ''}
                                ${r.environment.dockerVersion ? `<div class="env-item"><div class="env-label">Docker Version</div><div class="env-value">${r.environment.dockerVersion}</div></div>` : ''}
                            </div>
                            ${r.environment.relevantPackageVersions && Object.keys(r.environment.relevantPackageVersions).length ? `
                                <div class="packages-list">
                                    ${Object.entries(r.environment.relevantPackageVersions).map(([name, version]) => `
                                        <div class="package-badge">
                                            <span class="package-name">${name}</span>
                                            <span class="package-version">${version}</span>
                                        </div>
                                    `).join('')}
                                </div>
                            ` : ''}
                        </div>
                    </div>
                    ` : ''}

                    <!-- Reproduction Steps -->
                    ${hasSteps ? `
                    <div class="collapsible open">
                        <div class="collapsible-header" onclick="this.parentElement.classList.toggle('open')">
                            <div class="collapsible-title">
                                <svg viewBox="0 0 16 16"><path d="M1.5 3.25a2.25 2.25 0 113 2.122v5.256a2.251 2.251 0 11-1.5 0V5.372A2.25 2.25 0 011.5 3.25zm5.677-.177L9.573.677A.25.25 0 0110 .854v4.792a.25.25 0 01-.427.177L7.177 3.427a.25.25 0 010-.354zM3.75 2.5a.75.75 0 100 1.5.75.75 0 000-1.5zm0 9.5a.75.75 0 100 1.5.75.75 0 000-1.5z"/></svg>
                                Reproduction Steps (${r.reproductionSteps.length})
                            </div>
                            <svg class="collapsible-chevron" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M12.78 6.22a.75.75 0 010 1.06l-4.25 4.25a.75.75 0 01-1.06 0L3.22 7.28a.75.75 0 011.06-1.06L8 9.94l3.72-3.72a.75.75 0 011.06 0z"/></svg>
                        </div>
                        <div class="collapsible-content">
                            <div class="steps-list">
                                ${r.reproductionSteps.map(step => `
                                    <div class="step">
                                        <div class="step-header">
                                            <div class="step-number">${step.stepNumber}</div>
                                            <div class="step-description">${escapeHtml(step.description)}</div>
                                        </div>
                                        <div class="step-content">
                                            ${step.command ? `<div class="step-command">${escapeHtml(step.command)}</div>` : ''}
                                            ${step.output ? `<div class="step-output">${escapeHtml(step.output)}</div>` : ''}
                                            ${step.fileChanges ? `
                                                <div class="step-file">
                                                    <div class="step-file-path">üìÑ ${step.fileChanges.file}</div>
                                                    <div class="step-file-content">${escapeHtml(step.fileChanges.content)}</div>
                                                </div>
                                            ` : ''}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                    ` : ''}

                    <!-- Source Code Investigation -->
                    ${hasSourceInvestigation ? `
                    <div class="collapsible open">
                        <div class="collapsible-header" onclick="this.parentElement.classList.toggle('open')">
                            <div class="collapsible-title">
                                <svg viewBox="0 0 16 16"><path d="M4.72 3.22a.75.75 0 011.06 1.06L2.06 8l3.72 3.72a.75.75 0 11-1.06 1.06L.47 8.53a.75.75 0 010-1.06l4.25-4.25zm6.56 0a.75.75 0 10-1.06 1.06L13.94 8l-3.72 3.72a.75.75 0 101.06 1.06l4.25-4.25a.75.75 0 000-1.06l-4.25-4.25z"/></svg>
                                Source Code Investigation
                            </div>
                            <svg class="collapsible-chevron" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M12.78 6.22a.75.75 0 010 1.06l-4.25 4.25a.75.75 0 01-1.06 0L3.22 7.28a.75.75 0 011.06-1.06L8 9.94l3.72-3.72a.75.75 0 011.06 0z"/></svg>
                        </div>
                        <div class="collapsible-content">
                            ${r.sourceCodeInvestigation.searchCommands?.length ? `
                                <div class="source-title">Search Commands</div>
                                <div class="search-commands">
                                    ${r.sourceCodeInvestigation.searchCommands.map(cmd => `<div class="search-cmd">${escapeHtml(cmd)}</div>`).join('')}
                                </div>
                            ` : ''}

                            ${r.sourceCodeInvestigation.relevantFiles?.length ? `
                                <div class="source-title">Relevant Files</div>
                                <div class="file-list">
                                    ${r.sourceCodeInvestigation.relevantFiles.map(f => `
                                        <div class="file-item">
                                            <div class="file-path">${f.path}</div>
                                            <div class="file-reason">${escapeHtml(f.reason)}</div>
                                        </div>
                                    `).join('')}
                                </div>
                            ` : ''}

                            ${r.sourceCodeInvestigation.bugLocation ? `
                                <div class="source-title">Bug Location</div>
                                <div class="bug-location">
                                    <div class="bug-location-header">
                                        <div class="bug-location-file">${r.sourceCodeInvestigation.bugLocation.file}</div>
                                        ${r.sourceCodeInvestigation.bugLocation.lineRange ? `<div class="bug-location-lines">Lines ${r.sourceCodeInvestigation.bugLocation.lineRange}</div>` : ''}
                                    </div>
                                    ${r.sourceCodeInvestigation.bugLocation.method ? `<div class="bug-location-method">${escapeHtml(r.sourceCodeInvestigation.bugLocation.method)}</div>` : ''}
                                    ${r.sourceCodeInvestigation.bugLocation.code ? `<div class="bug-location-code">${escapeHtml(r.sourceCodeInvestigation.bugLocation.code)}</div>` : ''}
                                </div>
                            ` : ''}

                            ${r.sourceCodeInvestigation.rootCause ? `
                                <div class="root-cause">
                                    <div class="cause-label">Root Cause</div>
                                    <div class="cause-text">${escapeHtml(r.sourceCodeInvestigation.rootCause)}</div>
                                </div>
                            ` : ''}

                            ${r.sourceCodeInvestigation.proposedFix ? `
                                <div class="proposed-fix">
                                    <div class="cause-label">Proposed Fix</div>
                                    <div class="cause-text">${escapeHtml(r.sourceCodeInvestigation.proposedFix)}</div>
                                </div>
                            ` : ''}

                            ${r.sourceCodeInvestigation.additionalContext ? `
                                <div style="margin-top:12px; padding:14px 18px; background:var(--bg-primary); border:1px solid var(--border-muted); border-radius:10px; font-size:14px; color:var(--text-secondary); line-height:1.6;">
                                    <strong style="color:var(--text-primary)">Additional Context:</strong> ${escapeHtml(r.sourceCodeInvestigation.additionalContext)}
                                </div>
                            ` : ''}
                        </div>
                    </div>
                    ` : ''}

                    <!-- Error Messages -->
                    ${hasErrors ? `
                    <div class="collapsible open">
                        <div class="collapsible-header" onclick="this.parentElement.classList.toggle('open')">
                            <div class="collapsible-title">
                                <svg viewBox="0 0 16 16"><path d="M4.47.22A.749.749 0 015 0h6c.199 0 .389.079.53.22l4.25 4.25c.141.14.22.331.22.53v6a.749.749 0 01-.22.53l-4.25 4.25A.749.749 0 0111 16H5a.749.749 0 01-.53-.22L.22 11.53A.749.749 0 010 11V5c0-.199.079-.389.22-.53Zm.84 1.28L1.5 5.31v5.38l3.81 3.81h5.38l3.81-3.81V5.31L10.69 1.5ZM8 4a.75.75 0 01.75.75v3.5a.75.75 0 01-1.5 0v-3.5A.75.75 0 018 4zm0 8a1 1 0 100-2 1 1 0 000 2z"/></svg>
                                Error Messages
                            </div>
                            <svg class="collapsible-chevron" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M12.78 6.22a.75.75 0 010 1.06l-4.25 4.25a.75.75 0 01-1.06 0L3.22 7.28a.75.75 0 011.06-1.06L8 9.94l3.72-3.72a.75.75 0 011.06 0z"/></svg>
                        </div>
                        <div class="collapsible-content">
                            ${r.errorMessages.primaryError ? `
                                <div class="error-block">
                                    <div class="error-header">Primary Error</div>
                                    <div class="error-content">${escapeHtml(r.errorMessages.primaryError)}</div>
                                </div>
                            ` : ''}

                            ${r.errorMessages.stackTrace ? `
                                <div class="error-block">
                                    <div class="error-header">Stack Trace</div>
                                    <div class="error-content">${escapeHtml(r.errorMessages.stackTrace)}</div>
                                </div>
                            ` : ''}

                            ${r.errorMessages.containerLogs ? `
                                <div class="error-block">
                                    <div class="error-header">Container Logs</div>
                                    <div class="error-content">${escapeHtml(r.errorMessages.containerLogs)}</div>
                                </div>
                            ` : ''}

                            ${r.errorMessages.buildErrors ? `
                                <div class="error-block">
                                    <div class="error-header">Build Errors</div>
                                    <div class="error-content">${escapeHtml(r.errorMessages.buildErrors)}</div>
                                </div>
                            ` : ''}

                            ${r.errorMessages.additionalErrors?.length ? `
                                <div class="source-title" style="margin-top:16px">Additional Errors</div>
                                <div class="additional-errors">
                                    ${r.errorMessages.additionalErrors.map(err => `<div class="additional-error-item">${escapeHtml(err)}</div>`).join('')}
                                </div>
                            ` : ''}
                        </div>
                    </div>
                    ` : ''}
                </div>
            `;
            updateNav();
        }

        function updateNav() {
            document.getElementById('page').innerHTML = `<span class="current">${idx + 1}</span> / <span>${filtered.length}</span>`;
            document.getElementById('prev').disabled = idx === 0;
            document.getElementById('next').disabled = idx >= filtered.length - 1;
            // Update hash with current bug ID (push to history)
            if (filtered[idx]) {
                const newHash = '#' + filtered[idx].bugId;
                if (window.location.hash !== newHash) {
                    history.pushState(null, '', newHash);
                }
            }
        }

        function next() { 
            if (idx < filtered.length - 1) { 
                idx++; 
                render(); 
            } 
        }
        
        function prev() { 
            if (idx > 0) { 
                idx--; 
                render(); 
            } 
        }

        function goToBug(bugId) {
            // First check if in current filtered list
            let index = filtered.findIndex(r => r.bugId === bugId);
            if (index !== -1) {
                idx = index;
                render();
                return;
            }
            // If not found, reset to 'all' filter and find it
            const allIndex = data.investigations.findIndex(r => r.bugId === bugId);
            if (allIndex !== -1) {
                filter = 'all';
                filtered = data.investigations;
                idx = allIndex;
                renderFilters();
                render();
            }
        }

        function handleHash() {
            const hash = window.location.hash.slice(1);
            if (hash) {
                const bugId = parseInt(hash, 10);
                if (!isNaN(bugId)) {
                    goToBug(bugId);
                }
            }
        }

        window.addEventListener('popstate', handleHash);

        document.addEventListener('keydown', e => {
            if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); next(); }
            else if (e.key === 'ArrowLeft') { e.preventDefault(); prev(); }
        });

        load();
    </script>
</body>
</html>
